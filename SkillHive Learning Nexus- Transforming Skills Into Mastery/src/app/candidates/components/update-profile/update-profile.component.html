<body>
  <app-header></app-header>
  <div class="update-profile">
    <div *ngIf="candidate">
      <h2>Update Candidate Profile</h2>
      <form (ngSubmit)="onUpdate()" #updateForm="ngForm">
        <div *ngIf="errorMessage" class="error">{{ errorMessage }}</div>
        <div *ngIf="successMessage" class="success">{{ successMessage }}</div>

        <label class="user-img" [ngStyle]="{ 'background-image': additionalDetails.profilePicture ? 'url(' + additionalDetails.profilePicture + ')' : (newProfile ? 'url(' + newProfile + ')' : '')}"  for="newprofile"></label>
        <input id="newprofile" (change)="onFileSelected($event)" type="file" >
        <label for="username">Username</label>
        <input id="username" [(ngModel)]="candidate.fullName" name="username" required readonly />

        <label for="email">Email</label>
        <input type="email"
          id="email"
          [(ngModel)]="candidate.email"
          name="email"
          readonly
          required
          #emailInput="ngModel"
        />
        <div *ngIf="emailInput.invalid && emailInput.touched" class="error">
          Email is required and must be a valid format.
        </div>

        <label for="phoneNumber">Phone Number</label>
        <input
          id="phoneNumber"
          [(ngModel)]="additionalDetails.phoneNumber"
          name="phoneNumber"
          required
          pattern="^(?!0)[0-9]{10}$"
          #phoneInput="ngModel"
        />
        <div *ngIf="phoneInput.invalid && phoneInput.touched" class="error">
          Phone number must be exactly 10 digits and contain no spaces or symbols.
        </div>

        <label for="location">Location</label>
        <input id="location" [(ngModel)]="additionalDetails.location" name="location" required />

        <label for="specialization">Specialization</label>
        <input id="specialization" [(ngModel)]="additionalDetails.specialization" name="specialization" required />

        <label for="companyName">Company/College Name</label>
        <input id="companyName" [(ngModel)]="additionalDetails.companyName" name="companyName" required />

        <label for="gender">Gender</label>
        <select id="gender" [(ngModel)]="additionalDetails.gender" name="gender" required>
          <option value="" disabled selected>Select Gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>

        <label for="status">Status</label>
        <select id="status" [(ngModel)]="additionalDetails.status" name="status" required>
          <option value="" disabled selected>Select your status</option>
          <option value="Graduate">Graduate</option>
          <option value="Working">Working</option>
          <option value="Studying">Studying</option>
        </select>

        <button (click)="back()">Back</button>
        <button type="submit" class="btn-btn-primary" [disabled]="updateForm.invalid">
          Update Profile
        </button>
        <button type="button" (click)="navigateToChangePassword()" class="btn-btn-primary">
          Change Password
        </button>
      </form>
    </div>

    <div *ngIf="!candidate">
      <p>Loading...</p>
    </div>

    <p class="error-message" *ngIf="errorMessage">{{ errorMessage }}</p>
    <p class="success-message" *ngIf="successMessage">{{ successMessage }}</p>
  </div>
  <section>
    <app-footer></app-footer>
  </section>

</body>
